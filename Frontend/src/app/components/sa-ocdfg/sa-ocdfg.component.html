<div class="sa-ocdfg-container">
  <div class="legend" *ngIf="!loading">
    <div class="legend-items">
      <div *ngFor="let type of objectTypeColors | keyvalue" 
           class="legend-item" 
           [class.inactive]="!isObjectTypeActive(type.key)"
           (click)="toggleObjectType(type.key)">
        <div class="legend-color" [style.background-color]="type.value"></div>
        <span>{{ type.key }}</span>
      </div>
    </div>
  </div>
  
  <div class="decoration-selector" *ngIf="!loading">
    <div class="decoration-label">Edge decoration:</div>
    <div class="decoration-options">
      <button *ngFor="let option of decorationOptions"
              class="decoration-option"
              [class.active]="selectedDecoration === option"
              (click)="selectDecoration(option)">
        {{ option }}
      </button>
    </div>
    <label class="checkbox">
      <input type="checkbox" [(ngModel)]="onlyLifecycleEvents" (change)="onLifecycleToggle()">
      Only START/ST CHANGE/END
    </label>
    <div class="edge-filter" *ngIf="selectedEdge">
      <span class="edge-label">{{ selectedEdge.source }} -> {{ selectedEdge.target }}</span>
      <div class="filter-row">
        <label>Min:</label>
        <div class="time-selector">
          <div class="time-input">
            <input type="number" min="0" [(ngModel)]="filterMinDuration.days" (ngModelChange)="updateFilterMin()">
            <span class="unit">D</span>
          </div>
          <div class="time-input">
            <input type="number" min="0" [(ngModel)]="filterMinDuration.hours" (ngModelChange)="updateFilterMin()">
            <span class="unit">H</span>
          </div>
          <div class="time-input">
            <input type="number" min="0" [(ngModel)]="filterMinDuration.minutes" (ngModelChange)="updateFilterMin()">
            <span class="unit">M</span>
          </div>
          <div class="time-input">
            <input type="number" min="0" [(ngModel)]="filterMinDuration.seconds" (ngModelChange)="updateFilterMin()">
            <span class="unit">S</span>
          </div>
        </div>
      </div>
      <div class="filter-row">
        <label>Max:</label>
        <div class="time-selector">
          <div class="time-input">
            <input type="number" min="0" [(ngModel)]="filterMaxDuration.days" (ngModelChange)="updateFilterMax()">
            <span class="unit">D</span>
          </div>
          <div class="time-input">
            <input type="number" min="0" [(ngModel)]="filterMaxDuration.hours" (ngModelChange)="updateFilterMax()">
            <span class="unit">H</span>
          </div>
          <div class="time-input">
            <input type="number" min="0" [(ngModel)]="filterMaxDuration.minutes" (ngModelChange)="updateFilterMax()">
            <span class="unit">M</span>
          </div>
          <div class="time-input">
            <input type="number" min="0" [(ngModel)]="filterMaxDuration.seconds" (ngModelChange)="updateFilterMax()">
            <span class="unit">S</span>
          </div>
        </div>
      </div>
      <button class="filter-btn" (click)="applyEdgeFilter()">Filter</button>
    </div>
  </div>
  
  <div *ngIf="loading" class="loading">Loading graph...</div>
  
  <div *ngIf="!loading" class="graph-container">
    <svg #svgContainer class="graph-svg"></svg>
  </div>
</div>

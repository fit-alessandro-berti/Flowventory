<div class="causal-explorer-container">
  <div class="controls">
    <div class="control-group">
      <label for="leadObjectType">Lead Object Type:</label>
      <select id="leadObjectType" [(ngModel)]="leadObjectType" (change)="onLeadObjectTypeChange()">
        <option *ngFor="let type of objectTypes" [value]="type">{{ type }}</option>
      </select>
    </div>
    <div class="control-group">
      <label>Observed Variables:</label>
      <div class="variable-list">
        <label *ngFor="let v of availableObservedVariables" class="var-item">
          <input type="checkbox"
                 [checked]="selectedObservedVariables.includes(v.id)"
                 (change)="onObservedToggle(v.id, $any($event.target).checked)">
          {{ v.name }}
        </label>
      </div>
    </div>
    <div class="control-group">
      <label>Latent Variables:</label>
      <div class="variable-list">
        <label *ngFor="let v of availableLatentVariables" class="var-item">
          <input type="checkbox"
                 [checked]="selectedLatentVariables.includes(v.id)"
                 (change)="onLatentToggle(v.id, $any($event.target).checked)">
          {{ v.name }}
        </label>
      </div>
    </div>
    <button class="redraw-btn" (click)="onRedrawClick()">Redraw Graph</button>
  </div>

  <div class="legend">
    <div class="legend-item">
      <div class="legend-shape latent"></div>
      <span>Latent Variables</span>
    </div>
    <div class="legend-item">
      <div class="legend-color complexity"></div>
      <span>Complexity Indicators</span>
    </div>
    <div class="legend-item">
      <div class="legend-color performance"></div>
      <span>Performance Indicators</span>
    </div>
    <div class="legend-item">
      <span style="margin-left: 1rem;">â†’ Path coefficient on edge</span>
    </div>
  </div>
  
  <div class="tabs" *ngIf="!loading">
    <button (click)="setActiveTab('graph')" [class.active]="activeTab==='graph'">Causal Graph</button>
    <button (click)="setActiveTab('matrix')" [class.active]="activeTab==='matrix'">Correlation Matrix</button>
  </div>

  <div *ngIf="loading" class="loading">Loading structural equation model...</div>

  <div *ngIf="!loading && activeTab==='graph'" class="graph-container">
    <svg #svgContainer class="graph-svg"></svg>
  </div>

  <div *ngIf="!loading && activeTab==='matrix'" class="graph-container">
    <svg #matrixSvg class="graph-svg"></svg>
  </div>
</div>
